Status as of 2026-01-27:

Implemented (plan steps 1–8 complete; checks run after each):
- Server API refactor: new routing layer + utilities (server/routes/index.ts, server/http.ts) and slimmer server/apiPlugin.ts.
- Config/path safety extracted to server/config.ts.
- DB + logging extracted to server/db/index.ts and server/logging.ts.
- Indexing + session-tree builders extracted to server/indexing/index.ts and server/indexing/tree.ts.
- Search normalization + queries extracted to server/search/normalize.ts and server/search/queries.ts.
- Workspace helpers extracted and search updated to use Option A summaries (server/workspaces.ts).
- Search performance: workspace filter applied in matches CTE, workspace summaries limited to result workspaces, early empty guard.
- Server-Timing headers + requestId echo for /api/search and /api/session-matches.

Not implemented yet (plan steps 9–11):
- Shared API types (shared/apiTypes.ts) + update client/server imports and tsconfig includes.
- Docs updates (README/AGENTS + note about a “clean third approach” if Option A is slow).
- Tests (explicitly deferred).

Docs to understand the original plan + current status:
- Original plan: todos/2026-01-27-12pm_search-api-refactor-plan.txt
- Related context: todos/_done/2026-01-27-2pm_search-sorting-controls-context.txt
- Current status: task_plan.md, progress.md, findings.md
